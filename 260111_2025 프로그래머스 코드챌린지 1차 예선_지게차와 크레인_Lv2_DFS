//O(storages * requests)
//테두리를 비어있는 값으로 만들어서 추가해놓고 dfs를 돌아 지게차 사용 가능 여부 판단 
//테두리 만들때 = string(m+2,' ')으로 만들어야했음. ' '*(m+2) 불가능
//이거 말고 다른 값을 찾은 후에 dfs를 돌아 쭉쭉 가서 가장자리 까지 연결이 된다면 가능으로 판단도 가능. (테두리 추가 필요 없음)
//함수에서 vector 값 변경 원하면  &사용하기.


#include <string>
#include <vector>

using namespace std;

void takeall(char x,vector<string> &newstorage,int n,int m){
    for(int i=1;i<n+1;i++){
        for(int j=1;j<m+1;j++){
            if(newstorage[i][j] == x){
                newstorage[i][j] = ' ';
            }
        }
    }
}

void dfs(vector<string> &newstorage,vector<vector<bool>> &visited, int n,int m,int x,int y,char c){
    if (visited[x][y] == true) return;
    visited[x][y] = true;
    int dirx[] = {0,0,1,-1};
    int diry[] = {1,-1,0,0};
    for(int i=0;i<4;i++){
        int forx = dirx[i] + x;
        int fory = diry[i] + y;
        if(forx <0 or forx >= n+2 or fory <0 or fory >= m+2) continue;
        if(newstorage[forx][fory] == c){
            newstorage[forx][fory] = '0';
        }
        else if(newstorage[forx][fory] == ' '){
            dfs(newstorage,visited,n,m,forx,fory,c);
        }
    }
}

int solution(vector<string> storage, vector<string> requests) {
    int answer = 0;
    int n = storage.size();
    int m = storage[0].size();
    
    vector<string> newstorage(n+2);
    for(int i=0;i<n+2;i++){
        newstorage[i] = string(m+2, ' ');
    }
    for(int i=1;i<n+1;i++){
        for(int j=1;j<m+1;j++){
            newstorage[i][j] = storage[i-1][j-1];
        }
    }
    
    for(int i=0;i<requests.size();i++)
    {
        if(requests[i].size() == 2)
            takeall(requests[i][0],newstorage,n,m);
        else
        {
            vector<vector<bool>> visited(n+2,vector<bool>(m+2,false));
            dfs(newstorage,visited,n,m,0,0,requests[i][0]);
            for(int i=1;i<n+1;i++)
            {
                for(int j=1;j<m+1;j++)
                {
                    if(newstorage[i][j] == '0')
                    {
                        newstorage[i][j] = ' ';
                    }
                }
            }
        }
    }
    
    for(int i=1;i<n+1;i++){
        for(int j=1;j<m+1;j++){
            if(newstorage[i][j] != ' ') answer++;
        }
    }
    return answer;
}
